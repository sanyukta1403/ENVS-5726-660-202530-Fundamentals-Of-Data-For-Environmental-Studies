from pathlib import Path
import csv
from datetime import datetime

my_folder = Path('/Users/sanyuktasingh/Desktop/data class/SEC 10K')

headers = ['Company Name', 'Year', 'Count Sustainability', 'Count AI']
table = []

for my_file in my_folder.glob('*'):
    name_split = my_file.name.split('-')[0].lower() #take the first part of the name and 'lower' makes it case insensitive 
    
    company_name = name_split.replace('amzn', 'Amazon').replace('msft', 'Microsoft').replace('goog', 'Google').replace('nvda', 'Nvidea') #replaced shorthands for full name
    
    date_string = my_file.name.split('-')[-1].split('.')[0].split('_')[-1] #removed other variables to keep just the date
    my_dates = datetime.strptime(date_string, '%Y%m%d') #converted the date which is in a string to datetime
    year = my_dates.year

    with open(my_file, 'r', encoding='cp1252') as file: #encoding='utf-8' doesnt include all the characters so we used a different encoding
        content = file.read()
        sustainability_counter = content.lower().count('sustainability') #we dont use len here because it counts each each letter in the word
        ai_counter = content.lower().count('artificial intelligence')

    table.append([company_name, my_dates.year, sustainability_counter, ai_counter])

print(headers) #so that headers are seperate and not part of the analysis because they don't contain the actual data
for row in sorted(table)[:10]: #did sorted to ensure the order is correct + ':' means starting at the beginning and ending at 10th row
    print(row)


